+ Pending TODO: is T(ABCD)=A'B'C'D' correct? Could I do better?